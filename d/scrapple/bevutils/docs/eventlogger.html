<html><head>
	<META http-equiv="content-type" content="text/html; charset=utf-8">
	<title>bevutils.eventlogger</title>
	</head><body>
	<h1>bevutils.eventlogger</h1>
	<!-- Generated by Ddoc from eventlogger.d -->
<b>Authors:</b><br>
Steve Teale - steve.teale@britseyeview.com

<br><br>
<b>Date:</b><br>
2007/05/19
<br><br>
<b>History:</b><br>
V0.1
<br><br>
<b>License:</b><br>
Use freely for any purpose.
 
<br><br>

<dl><dt><big>class <u>EventLogger</u>;
</big></dt>
<dd>A class to write entries to the Windows system event log.
 
<br><br>

<dl><dt><big>this(char[] <i>appName</i>, bool <i>forceRegEntry</i> = true);
</big></dt>
<dd>This is an explicit constructor to set a specific event source.
<br><br>
To log an event, the event source must exist in the registry, and so the constructor
 by default will ensure that an appropriate registry entry exists. For this to work,
 the message file gpmf.dll must be present in the SYSTEM32 directory.

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>appName</i></td>
<td>The event source name</td></tr>
<tr><td>bool <i>forceRegEntry</i></td>
<td>Whether to attempt to create the event source registry entry.
                    If the entry already exists, no action is taken.</td></tr>
</table><br>

</dd>
<dt><big>this(bool <i>forceRegEntry</i> = true);
</big></dt>
<dd>A general-purpose constructor to set the event source from the module file name.
<br><br>
To log an event, the event source must exist in the registry, and so the constructor
 by default will ensure that an appropriate registry entry exists. For this to work,
 the message file gpmf.dll must be present in the SYSTEM32 directory.

<br><br>
<b>Params:</b><br>
<table><tr><td>bool <i>forceRegEntry</i></td>
<td>Whether to attempt to create the event source registry entry.
                    If the entry already exists, no action is taken.</td></tr>
</table><br>

</dd>
<dt><big>static bool <u>createRegistryEntry</u>(char[] <i>appName</i>);
</big></dt>
<dd>Creates an event-source entry in HKLM\SOFTWARE\CurrentControlSet\Services\Eventlog.
<br><br>
To log an event properly, an event source must exist in the registry. This method
 creates an entry pointing to %SYSTEM32%\gpmf.dll, which is a very basic message file
 with the usual range of severity entries, and with a single %1 replacement token.

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>appName</i></td>
<td>The event source name</td></tr>
</table><br>

</dd>
<dt><big>void <u>logEvent</u>(char[] <i>msg</i>, ushort <i>severity</i>);
</big></dt>
<dd>Log a message to the system event log.
<br><br>
This is a general for where you specify the message and the <i>severity</i>.  For <i>severity</i>,
 use the enum values EVENTLOG_SUCCESS (no message prefix), EVENTLOG_INFO_TYPE
 (Info: message prefix), EVENTLOG_WARNING_TYPE (Warning: message prefix),
 EVENTLOG_ERROR_TYPE (Error: message prefix).

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>msg</i></td>
<td>The message to be logged.</td></tr>
<tr><td>ushort <i>severity</i></td>
<td>Enum values as above.</td></tr>
</table><br>

</dd>
<dt><big>void <u>logMessage</u>(char[] <i>msg</i>);
</big></dt>
<dd>Log a general purpose message to the system event log.
<br><br>
This is a specific method implemented as
 <u>logMessage</u>(char[] <i>msg</i>) { logEvent(<i>msg</i>, EVENTLOG_SUCCESS); }

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>msg</i></td>
<td>The message to be logged.</td></tr>
</table><br>

</dd>
<dt><big>void <u>logInfo</u>(char[] <i>msg</i>);
</big></dt>
<dd>Log an information message to the system event log.
<br><br>
This is a specific method implemented as
 logMessage(char[] <i>msg</i>) { logEvent(<i>msg</i>, EVENTLOG_INFORMATION_TYPE); }

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>msg</i></td>
<td>The message to be logged.</td></tr>
</table><br>

</dd>
<dt><big>void <u>logWarning</u>(char[] <i>msg</i>);
</big></dt>
<dd>Log a warning message to the system event log.
<br><br>
This is a specific method implemented as
 logMessage(char[] <i>msg</i>) { logEvent(<i>msg</i>, EVENTLOG_WARNING_TYPE); }

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>msg</i></td>
<td>The message to be logged.</td></tr>
</table><br>

</dd>
<dt><big>void <u>logError</u>(char[] <i>msg</i>);
</big></dt>
<dd>Log an error message to the system event log.
<br><br>
This is a specific method implemented as
 logMessage(char[] <i>msg</i>) { logEvent(<i>msg</i>, EVENTLOG_ERROR_TYPE); }

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>msg</i></td>
<td>The message to be logged.</td></tr>
</table><br>

</dd>
<dt><big>char[] <u>getWindowsErrorText</u>(uint <i>errnum</i>);
</big></dt>
<dd>Get an error message from Windows given a Win32 error number.
<br><br>
<b>Params:</b><br>
<table><tr><td>uint <i>errnum</i></td>
<td>The error number for which to recover a message.</td></tr>
</table><br>

</dd>
<dt><big>void <u>logWindowsError</u>(char[] <i>msg</i>, uint <i>errnum</i>);
</big></dt>
<dd>Log an error message incorporating Win32 error details to the system event log.
<br><br>
This method allows you to provide the error number from GetLastError().

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>msg</i></td>
<td>The message to be prepended to the error details.</td></tr>
<tr><td>uint <i>errnum</i></td>
<td>The return value from GetLastError().</td></tr>
</table><br>

</dd>
<dt><big>void <u>logWindowsError</u>(char[] <i>msg</i>);
</big></dt>
<dd>Log an error message incorporating Win32 error details to the system event log.
<br><br>
This method calls GetLastError() to get the error number for you.

<br><br>
<b>Params:</b><br>
<table><tr><td>char[] <i>msg</i></td>
<td>The message to be prepended to the error details.</td></tr>
<tr><td>errnum</td>
<td>The return value from GetLastError().</td></tr>
</table><br>

</dd>
</dl>
</dd>
</dl>

	<hr><small>Page generated by <a href="http://www.digitalmars.com/d/ddoc.html">Ddoc</a>. </small>
	</body></html>
