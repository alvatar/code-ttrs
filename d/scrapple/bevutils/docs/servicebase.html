<html><head>
	<META http-equiv="content-type" content="text/html; charset=utf-8">
	<title>bevutils.servicebase</title>
	</head><body>
	<h1>bevutils.servicebase</h1>
	<!-- Generated by Ddoc from servicebase.d -->
<b>Authors:</b><br>
Steve Teale - steve.teale@britseyeview.com

<br><br>
<b>Date:</b><br>
2007/05/19
<br><br>
<b>History:</b><br>
V0.1
<br><br>
<b>License:</b><br>
Use freely for any purpose.
 
<br><br>

<dl><dt><big>class <u>ServiceBase</u>;
</big></dt>
<dd>A class to provide the internals of a windows service, including installation and removal.
<br><br>
The class has few methods that you would call from a host program.
 All detailed implementation must be provided by a derived class.
<br><br>

 An example of its use to create a service executable is presented below.
<br><br>

 To install the service run derived.exe -i, to remove it run derived.exe -r.
<br><br>

<pre class="d_code"><font color=green>// Derive a class from ServiceBase implementing the abstract methods.
</font><font color=blue>class</font> NullService : <u>ServiceBase</u>
{
    <font color=blue>this</font>()
    {
        <font color=blue>super</font>(<font color=red>"Dummy"</font>, <font color=blue>false</font>);
    }

    <font color=blue>public</font> <font color=blue>void</font> onServiceStart(<font color=blue>char</font>[][] args)
    {
        <u>ServiceBase</u>.EventLog.logMessage(<font color=red>"NullService onServiceStart was called"</font>);
    }

    <font color=blue>public</font> <font color=blue>void</font> onServiceStop()
    {
        <u>ServiceBase</u>.EventLog.logMessage(<font color=red>"NullService onServiceStop was called"</font>);
    }
}

<font color=green>// Create an object of the derived class, then call the base class implementMain method.
</font><font color=blue>void</font> main(<font color=blue>char</font>[][] args)
{
    <font color=blue>try</font>
    {
        <u>ServiceBase</u> sb = <font color=blue>new</font> NullService();
        <u>ServiceBase</u>.implementMain(args);
    }
    <font color=blue>catch</font> (Exception ex)
    {
        writefln(ex.toString());
    }
}
</pre>
 
<br><br>

<dl><dt><big>static char* <u>CName</u>();
</big></dt>
<dd>Get the service name as a C style string.
     
<br><br>

</dd>
<dt><big>static EventLogger <u>EventLog</u>();
</big></dt>
<dd>Get a reference to the services event logger.
     
<br><br>

</dd>
<dt><big>static char[] <u>Name</u>();
</big></dt>
<dd>Get the service name as a D style string.
     
<br><br>

</dd>
<dt><big>export static void <u>service_ctrl</u>(uint <i>dwCtrlCode</i>);
</big></dt>
<dd>This method should be called only by the SCM.
     
<br><br>

</dd>
<dt><big>export static void <u>service_main</u>(uint <i>dwArgc</i>, char** <i>args</i>);
</big></dt>
<dd>This method should be called only by the SCM.
     
<br><br>

</dd>
<dt><big>static bool <u>ReportStatusToSCMgr</u>(uint <i>dwCurrentState</i>, uint <i>dwWin32ExitCode</i>, uint <i>dwWaitHint</i>);
</big></dt>
<dd>This method can be called by a derived class during service stop to keep
 the SCM appraised of progress.
     
<br><br>

</dd>
<dt><big>static void <u>implementMain</u>(char[][] <i>args</i>);
</big></dt>
<dd>This method should be called by your main() function to implement the service.
     
<br><br>

</dd>
</dl>
</dd>
</dl>

	<hr><small>Page generated by <a href="http://www.digitalmars.com/d/ddoc.html">Ddoc</a>. </small>
	</body></html>
